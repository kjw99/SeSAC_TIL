## 데이터베이스

- 데이터베이스(Database)는 체계적으로 구조화된 데이터의 집합이다.
- 여러 사용자가 공유하여 사용할 수 있으며, 중복을 최소화하고 일관성을 유지하며 데이터를 저장한다.

### DBMS

- 데이터베이스 관리 시스템(Database Management System)은 데이터를 효율적으로 저장, 조회, 수정, 삭제할 수 있도록 도와주는 시스템이다.
- PostgreSQL, MySQL, Oracle, SQLite 등등이 있다.
    - SQLite = 파일 기반. 가볍다.
    - PostgreSQL = FastAPI에서 사용하기 좋다고 함. 잘 연동이 됨.

## **관계형 데이터베이스**

- 관계형 데이터베이스(Relational Database)는 데이터를 테이블로 구성하며, 각 테이블은 행과 열로 구성된다.
- 자료를 여러 테이블로 나누어서 관리하고, 테이블간 관계를 설정해 여러 데이터를 쉽게 조작할 수 있다,
- SQL(Structured Query Language)을 사용하여 데이터를 관리하고 검색한다.
- 테이블(Table)
    - 데이터베이스에서 데이터를 저장하는 기본 단위이다.
    - 행과 열의 격자 형태로 구성되며, 하나의 테이블은 특정 유형의 데이터를 나타냅니다.
    - ex) 고객 데이터를 담은 고객 테이블, 주문 데이터를 담은 주문 테이블
- 행(Row)
    - 격자의 가로 부분
    - 데이터 유형의 개별 항목을 나타낸다.
    - 각 행은 테이블 내에서 유일하며, 기본 키(Primary Key)로 구분된다.
    - 레코드, 튜플이라고도 한다.
    - ex) 고객 테이블의 ‘A 고객’에 대한 정보, ‘B 고객’에 대한 정보 등
- 열(Column)
    - 행이 가져야 하는 데이터의 종류를 정의한다.
    - 필드, 속성이라고도 한다.
    - ex) 고객 테이블의 ‘고객 이름’, ‘email’ 등
- ex)
    - 고객 테이블
        
        
        | **고객ID** | **고객이름** | **Email** |
        | --- | --- | --- |
        | 1 | 권이혁 | alex@example.com |
        | 2 | 배지원 | chelsea@example.com |
        | 3 | 유창준 | jun@example.com |
    - 주문 테이블
        
        
        | **주문ID** | **고객ID** | **상품명** | **날짜** |
        | --- | --- | --- | --- |
        | 101 | 1 | 노트북 | 2024-01-08 |
        | 102 | 2 | 핸드폰 | 2024-01-10 |
        | 103 | 1 | 태블릿 | 2024-01-12 |
        | 104 | 3 | 노트북 | 2024-01-15 |
- 기본 키(Primary key)
    - 레코드를 고유하게 식별하는 필드 또는 필드의 조합
    - 특징
        - 유일성: 중복된 값을 가질 수 없음
        - 최소성: 필요 최소한의 필드로 구성
        - NOT NULL: NULL 값을 가질 수 없음
    - 우리는 1부터 시작하는 정수형태의 기본 키만을 사용한다.
- 외래 키(Foreign Key)
    - 한 테이블의 필드 중 다른 테이블의 행(row)을 식별할 수 있는 키를 말한다

## 데이터베이스 관계

## 1:N 관계

- 1:N 관계(one to many relationship)은 한 테이블의 한 행이 다른 테이블의 여러 행과 관련이 있는 경우를 의미한다.
- 아래 예시에서, 고객 테이블의 `고객ID가 1`인 행이 주문 테이블의 `주문 ID가 101, 103`인 행과 관련이 있다.
- 고객 테이블
    
    
    | **고객ID** | **고객이름** | **Email** |
    | --- | --- | --- |
    | 1 | 권이혁 | alex@example.com |
    | 2 | 배지원 | chelsea@example.com |
    | 3 | 유창준 | jun@example.com |
- 주문 테이블
    
    
    | **주문ID** | **고객ID** | **상품명** | **날짜** |
    | --- | --- | --- | --- |
    | 101 | 1 | 노트북 | 2024-01-08 |
    | 102 | 2 | 핸드폰 | 2024-01-10 |
    | 103 | 1 | 태블릿 | 2024-01-12 |
- 이때, `고객ID` 는 고객 테이블의 PK(Primary Key)이고, 주문 테이블의 FK(Foreign Key)이다.

---

- 게시글 테이블
    
    
    | **게시글ID** | 제목 | 내용 |
    | --- | --- | --- |
    | 1 | 데이터베이스란? | 관계형 DB의 기초에 대해 알아봅시다. |
    | 2 | 맛집 추천 | 오늘 점심 메뉴 추천해주세요. |
    | 3 | 파이썬 공부법 | 기초부터 차근차근 시작하는 방법 |
- 댓글 테이블
    
    
    | **댓글ID** | 게시글ID | 댓글 내용 |
    | --- | --- | --- |
    | R101 | 1 | 좋습니다~ |
    | R102 | 2 | 배고프다 |
    | R103 | 1 | NoSQL은요? |

## M:N 관계

- M:N 관계(many to many relationship)는 한 테이블(A)의 한 행이 다른 테이블(B)의 여러 행과 관련이 있고, 반대로 한 테이블(B)의 한 행이 다른 테이블(A)의 여러 행과 관련이 있는 경우를 의미한다.
- 아래 예시에서
    - 고객 테이블의 `고객ID가 1`인 행이 주문 테이블의 `주문 ID가 101, 103`인 행과 관련이 있고, 따라서 `상품ID가 P001, P003`인 행과 관련이 있다.
    - 상품 테이블의 `상품ID가 P001`인 행이 주문 테이블의 `주문 ID가 101, 104`인 행과 관련이 있고, 따라서 `고객ID가 1, 3`인 행과 관련이 있다.
    - 즉 `고객 : 주문 = 1 : N`, `상품 : 주문 = 1 : N` 의 관계를 만족하는 경우 M:N  관계라고 한다.

- 고객 테이블
    
    
    | **고객ID** | **고객이름** | **Email** |
    | --- | --- | --- |
    | 1 | 권이혁 | alex@example.com |
    | 2 | 배지원 | chelsea@example.com |
    | 3 | 유창준 | jun@example.com |
- 주문 테이블
    
    
    | **주문ID** | **고객ID** | **상품ID** | **날짜** |
    | --- | --- | --- | --- |
    | 101 | 1 | P001 | 2024-01-08 |
    | 102 | 2 | P002 | 2024-01-10 |
    | 103 | 1 | P003 | 2024-01-12 |
    | 104 | 3 | P001 | 2023-12-25 |
- 상품 테이블
    
    
    | **상품ID** | **상품명** |
    | --- | --- |
    | P001 | 노트북 |
    | P002 | 핸드폰 |
    | P003 | 태블릿 |

---

- 배우 테이블
    
    
    | **배우ID** | **배우이름** |
    | --- | --- |
    | A1 | 송강호 |
    | A2 | 이정재 |
    | A3 | 설경구 |
- 출연 테이블
    
    
    | **출연ID** | **배우ID** | **영화ID** | **역할명** |
    | --- | --- | --- | --- |
    | C1 | A1 | M101 | 내경 (주연) |
    | C2 | A2 | M101 | 수양대군 (주연) |
    | C3 | A1 | M102 | 기택 (주연) |
    | C4 | A2 | M103 | 염라대왕 (특별출연) |
- 영화 테이블
    
    
    | **영화ID** | **영화제목** | **개봉연도** |
    | --- | --- | --- |
    | M101 | 관상 | 2013 |
    | M102 | 기생충 | 2019 |
    | M103 | 신과함께 | 2017 |

### 연관 테이블

- 연관 테이블은 M:N 관계에서 두 테이블 간의 관계를 표현하기 위해 사용된다.
    - M:N 관계는 관계형 데이터베이스에서 직접 표현할 수 없어, 연관 테이블을 통해 두 개의 1:N 관계로 분해하여 표현한다.
- 연관 테이블에는 두 테이블의 기본 키(PK)가 외래 키(FK)로서 포함된다.
- 위 예시의 `주문 테이블` 에는 `고객 테이블`과 `상품 테이블`의 PK가 FK로서 포함되고, `날짜` 데이터가 추가되어 있다.

### 교사 - 학생의 관계에서

- 교사 - 학생은 어떤 관계를 가지고 있을까?
    - 담임 교사의 관점
        - 한 담임 교사는 여러 학생과 관계가 있다.
            - 1 : N
        - 한 학생은 한명의 담임 교사와 관계가 있다.
            - 1 : 1
        - → 담임 교사 - 학생의 관계는 1 : N 관계이다.
    
    - 단순 교사의 관점
        - 한 교사는 여러 학생과 관계가 있다.
            - 1 : N
        - 한 학생은 여러 교사와 관계가 있다.
            - 1 : N
        - → 교사 - 학생의 관계는 M : N 관계이다.
- `추상화`를 어떻게 하느냐에 따라, 즉 우리가 원하는 product에서 원하는 것이 무엇인지에 따라 사용하는 모델도 달라지게 된다.
- 즉, 기획은 구체적이어야 한다.

## 1:1 관계

- 1:1 관계(one to one relationship)는 한 테이블의 한 행이 다른 테이블의 단 하나의 행과만 관련이 있는 경우를 의미한다.
- 아래 예시에서, 주문 테이블의 `주문 ID가 101`인 행이 환불 테이블의 `환불 ID가 R001`인 행과 관련이 있다.
- 주문 테이블
    
    
    | **주문ID** | **고객ID** | **상품ID** | **날짜** |
    | --- | --- | --- | --- |
    | 101 | 1 | P001 | 2024-01-08 |
    | 102 | 2 | P002 | 2024-01-10 |
    | 103 | 1 | P003 | 2024-01-12 |
    | 104 | 3 | P001 | 2023-12-25 |
- 환불 테이블
    
    
    | **환불ID** | **주문ID** | **환불사유** |
    | --- | --- | --- |
    | R001 | 101 | 제품 하자 |
    | R002 | 103 | 단순 변심 |
- 1:1 관계는 주로 다음과 같은 상황에서 사용된다:
    - 보안이 필요한 민감한 데이터 분리
    - 자주 사용하는 데이터와 그렇지 않은 데이터 분리
    - 선택적으로 존재하는 데이터 관리
    - 매우 큰 데이터를 별도로 관리